### /etc/wade/wade.conf (defaults) ##############################
WADE_HOSTNAME=""
WADE_OWNER_USER="autopsy"
WADE_SMB_USERS="autopsy,KAPE"
WADE_ALLOW_NETS=""                       # "10.0.0.0/24,10.0.1.0/24"

WADE_BASE_VAR="/var/wade"
WADE_BASE_ETC="/etc/wade"
WADE_LOG_DIR="${WADE_BASE_VAR}/logs"
WADE_PKG_DIR="${WADE_BASE_VAR}/pkg"
WADE_TOOLS_DIR="${WADE_BASE_VAR}/tools.d"
WADE_PIPELINES_DIR="${WADE_BASE_VAR}/pipelines.d"

WADE_DATADIR="DataSources"
WADE_CASESDIR="Cases"
WADE_STAGINGDIR="Staging"

WADE_OFFLINE="${OFFLINE:-0}"
WADE_STRICT_FIREWALL="0"

# Pinned versions
ZOOKEEPER_VER="3.5.7"
SOLR_VER="8.6.3"
ACTIVEMQ_VER="5.14.0"

# Java (headless recommended)
JAVA_PACKAGE_APT="default-jre-headless"
JAVA_PACKAGE_RPM="java-11-openjdk-headless"
SOLR_HEAP=""
# Leave SOLR_HEAP blank so Solr uses SOLR_JAVA_MEM below (Xms 24G, Xmx 48G).
SOLR_JAVA_MEM='-Xms24G -Xmx48G'
SOLR_ZK_HOST="127.0.0.1"

# PostgreSQL lab settings (unsafe for prod)
PG_LISTEN_ADDR="0.0.0.0"
PG_PERF_FSYNC="off"
PG_PERF_SYNCCOMMIT="off"
PG_PERF_FULLPAGE="off"
PG_CREATE_AUTOPSY_USER="1"

# ===== Splunk (UF + ports) =====
SPLUNK_DEFAULT_INDEX="wade_custom"

# Universal Forwarder defaults (used by the installer prompts & env)
SPLUNK_UF_RCVR_HOSTS="splunk.example.org:9997"
SPLUNK_UF_DEFAULT_INDEX="wade_custom"
SPLUNK_UF_COMPRESSED="true"
SPLUNK_UF_USE_ACK="true"
SPLUNK_UF_SSL_VERIFY="false"
SPLUNK_UF_SSL_COMMON_NAME="*"
SPLUNK_UF_DEPLOYMENT_SERVER=""

# Ports (for summary/UI hints)
SPLUNK_WEB_PORT="8000"
SPLUNK_MGMT_PORT="8089"
SPLUNK_HEC_PORT="8088"
SPLUNK_FORWARD_PORT="9997"

# Module toggles
MOD_VOL_SYMBOLS_ENABLED="1"
MOD_BULK_EXTRACTOR_ENABLED="1"
MOD_PIRANHA_ENABLED="1"
MOD_BARRACUDA_ENABLED="1"
MOD_HAYABUSA_ENABLED="1"

# Volatility3 runtime dirs
VOL3_BASE_DIR="/var/wade/vol3"
VOL3_SYMBOLS_DIR="${VOL3_BASE_DIR}/symbols"
VOL3_CACHE_DIR="${VOL3_BASE_DIR}/cache"
VOL3_PLUGIN_DIR="${VOL3_BASE_DIR}/plugins"

# Sigma disabled in this build
SIGMA_ENABLED="0"
SIGMA_AUTOUPDATE="0"

# Hayabusa locations
HAYABUSA_ARCH_AUTO="1"
HAYABUSA_ARCH_OVERRIDE=""
HAYABUSA_DEST="/usr/local/bin/hayabusa"
HAYABUSA_RULES_DIR="/etc/wade/hayabusa/rules"
SIGMA_RULES_DIR="/etc/wade/sigma"

# ---- Plaso / log2timeline ----
PLASO_ENABLED="1"                           # master toggle for installer
PLASO_DOCKER_IMAGE="log2timeline/plaso"     # default upstream image
PLASO_DOCKER_TAG="latest"                   # pin/tag if you want
PLASO_DOCKER_NAME="wade-plaso"              # container name

# Where raw timelines (storage files) will live
PLASO_STORAGE_ROOT="/home/${WADE_OWNER_USER:-autopsy}/Cases/plaso"

# Optional bind mount for images if you want a stable path inside the container
PLASO_IMAGE_ROOT_HOST="/home/${WADE_OWNER_USER:-autopsy}/DataSources/Hosts"
PLASO_IMAGE_ROOT_CONT="/mnt/hosts"

# Default log2timeline options (used later by workers)
PLASO_L2T_OPTS="--partition all --vss_stores all --status_view linear"

# Default psort output directory (JSON/CSV for Splunk)
PLASO_PSORT_JSON_ROOT="/home/${WADE_OWNER_USER:-autopsy}/Cases/plaso/json"

# ---- Mandiant capa (engine + rules) ----
CAPA_VERSION=""                         # blank = latest from PyPI
WADE_CAPA_VENV="/opt/wade/venvs/capa"   # dedicated venv for capa
WADE_CAPA_RULES_DIR="/opt/capa-rules"   # where rules live
WADE_CAPA_RULES_COMMIT=""               # optionally pin: commit SHA or tag

# ---- Whiff ----
# Non-interactive mode
WHIFF_NONINTERACTIVE=1

# Postgres (set DB_PASS!)
INSTALL_PG_LOCAL=1
DB_HOST=127.0.0.1
DB_PORT=5432
DB_NAME=whiff
DB_USER=whiff
DB_PASS=CHANGE_ME

# Whiff API
WHIFF_BIND="127.0.0.1"
WHIFF_PORT="8888"
WHIFF_THREADS="6"
WHIFF_CTX="4096"

# Online behavior
ONLINE_MODE=1
DL_MODELS_NOW=1
HF_TOKEN=              # leave empty unless you have a gated token

# Model locations (if you already have them on disk, point here)
LLM_PATH=/opt/whiff/models/whiff-llm.gguf
EMBED_DIR=/opt/whiff/models/emb/snowflake-m-v2

# Post-install options
SEED_BASELINE_DOCS=1
RUN_INITIAL_CRAWL=1    # keep 0 until DB is confirmed reachable
ENABLE_NIGHTLY_BACKFILL=1
PATCH_WADE_ENV=1
PACKAGE_SPLUNK_ADDON=1

# Prefer smaller CPU-only torch wheel
FORCE_TORCH_CPU=1

# ---- STIG (assessment only; interactive at end) ----
MOD_STIG_EVAL_ENABLED="1"         # keep prereqs enabled; eval runs interactively at end
MOD_STIG_REMEDIATE_ENABLED="0"    # do NOT apply fixes

# Reports
STIG_REPORT_DIR="/var/wade/logs/stig"

# Storage
STIG_STORE_DIR="/var/wade/stigs"
STIG_UBU_EXTRACT_DIR="${STIG_STORE_DIR}/ubuntu2404"
STIG_PROFILE_ID="xccdf_mil.disa.stig_profile_MAC-1_Classified"
STIG_SKIP_RULES=""

# ---- bulk_extractor installation mode ----
# "source" (build from GitHub) or "repo" (use distro package if available)
BULK_EXTRACTOR_MODE="source"
