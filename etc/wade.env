# ============================================================================
# =========================    WADE runtime facts    =========================
# ============================================================================
WADE_HOSTNAME="${LWADE}"
WADE_HOST_IPV4="${IPV4}"
WADE_OWNER_USER="${LWADEUSER}"
WADE_SMB_USERS="${SMB_USERS_CSV}"
WADE_ALLOW_NETS="${ALLOW_NETS_CSV}"

# ============================================================================
# Offline flag
# ============================================================================
OFFLINE="${OFFLINE}"

# ============================================================================
# Directories
# ============================================================================
WADE_DATADIR="${WADE_DATADIR}"
WADE_CASESDIR="${WADE_CASESDIR}"
WADE_STAGINGDIR="${WADE_STAGINGDIR}"
WADE_LOG_DIR="${WADE_LOG_DIR}"
WADE_PKG_DIR="${WADE_PKG_DIR}"
WADE_TOOLS_DIR="${WADE_TOOLS_DIR}"
WADE_PIPELINES_DIR="${WADE_PIPELINES_DIR}"

# ============================================================================
# Configuration
# ============================================================================
WADE_CONFIG_PATH=/etc/wade/config.yaml

# ============================================================================
# Logging
# ============================================================================
WADE_TEXT_LOGS=1
WADE_TEXT_LOG_LEVEL=DEBUG
WADE_FRAGMENT_LOG=/var/log/wade/fragmented_e01.log

# ============================================================================
# Splunk settings (UF actuals if present, else defaults)
# ============================================================================
SPLUNK_DEFAULT_INDEX="${SPLUNK_DEFAULT_INDEX:-wade_custom}"
SPLUNK_UF_RCVR_HOSTS="${UF_RCVR}"
SPLUNK_UF_DEFAULT_INDEX="${UF_IDX}"
SPLUNK_UF_COMPRESSED="${UF_COMP}"
SPLUNK_UF_USE_ACK="${UF_ACKS}"
SPLUNK_UF_SSL_VERIFY="${UF_SSLV}"
SPLUNK_UF_SSL_COMMON_NAME="${UF_SSLN}"
SPLUNK_UF_DEPLOYMENT_SERVER="${UF_DS}"

# ============================================================================
# Hayabusa locations
# ============================================================================
HAYABUSA_DEST="${HAYABUSA_DEST}"
HAYABUSA_RULES_DIR="${HAYABUSA_RULES_DIR}"
SIGMA_RULES_DIR="${SIGMA_RULES_DIR}"

# ============================================================================
# Staging Daemon Settings
# ============================================================================
WADE_STAGE_STABLE_SECONDS=180
WADE_STAGE_WAIT_STABLE=15
WADE_STAGE_POLL_INTERVAL=30
WADE_STAGE_REQUIRE_CLOSE_WRITE=1
WADE_STAGE_VERIFY_NO_WRITERS=1
WADE_AUTODEFRAG_E01=0
WADE_STAGE_RECURSIVE=1
WADE_STAGE_ACCEPT_DOCS=1
WADE_STAGE_SMALL_FILE_BYTES=2097152
WADE_STAGE_SMALL_FILE_STABLE=5
WADE_STAGE_DB=/var/wade/staging_state.db

# ============================================================================
# Queue 
# ============================================================================
WADE_QUEUE_DIR=_queue

# ============================================================================
# Tool Paths (auto-detected if not set)
# ============================================================================
WADE_EWFINFO_PATH=/usr/bin/ewfinfo
WADE_EWFEXPORT_PATH=/usr/bin/ewfexport
WADE_VOLATILITY3_PATH=/usr/local/bin/vol
WADE_LSOF_PATH=/usr/bin/lsof

# ============================================================================
# Plaso / log2timeline
# ============================================================================
PLASO_ENABLED="${PLASO_ENABLED}"
PLASO_DOCKER_IMAGE="${PLASO_DOCKER_IMAGE}"
PLASO_DOCKER_TAG="${PLASO_DOCKER_TAG}"
PLASO_DOCKER_NAME="${PLASO_DOCKER_NAME}"
PLASO_STORAGE_ROOT="${PLASO_STORAGE_ROOT}"
PLASO_IMAGE_ROOT_HOST="${PLASO_IMAGE_ROOT_HOST}"
PLASO_IMAGE_ROOT_CONT="${PLASO_IMAGE_ROOT_CONT}"
PLASO_L2T_OPTS="${PLASO_L2T_OPTS}"
PLASO_PSORT_JSON_ROOT="${PLASO_PSORT_JSON_ROOT}"

# ============================================================================
# WHIFF (non-secret settings)
# ============================================================================
WHIFF_ENABLE="${WHIFF_ENABLE_EFF}"
WHIFF_BIND_ADDR="${WHIFF_BIND}"
WHIFF_PORT="${WHIFF_PORT}"

# ============================================================================
# Derived convenience URL used by dashboards/integrations
# ============================================================================
WHIFF_URL="http://${WHIFF_BIND_ADDR}:${WHIFF_PORT}/annotate"

# NOTE: If you must persist tokens (NOT RECOMMENDED), uncomment the next line and paste carefully.
# WHIFF_API_KEY="<REDACTED>"

# ============================================================================
# ========================    Network ports in use    ========================
# ============================================================================
SSH_PORT="22"
SMB_TCP_139="139"
SMB_TCP_445="445"
SMB_UDP_137="137"
SMB_UDP_138="138"
ZK_CLIENT_PORT="2181"
ZK_QUORUM_PORT="2888"
ZK_ELECTION_PORT="3888"
SOLR_PORT="8983"
ACTIVEMQ_OPENWIRE_PORT="61616"
ACTIVEMQ_WEB_CONSOLE_PORT="8161"
ACTIVEMQ_AMQP_PORT="5672"
ACTIVEMQ_STOMP_PORT="61613"
ACTIVEMQ_MQTT_PORT="1883"
ACTIVEMQ_WS_PORT="61614"
POSTGRES_PORT="5432"
WHIFF_PORT="8088"
BARRACUDA_PORT="5000"
SPLUNK_WEB_PORT="\${SPLUNK_WEB_PORT}"
SPLUNK_MGMT_PORT="\${SPLUNK_MGMT_PORT}"
SPLUNK_HEC_PORT="\${SPLUNK_HEC_PORT}"
SPLUNK_FORWARD_PORT="\${SPLUNK_FORWARD_PORT}"

WADE_SERVICE_PORTS_CSV="\${SSH_PORT},\${SMB_TCP_139},\${SMB_TCP_445},\${SMB_UDP_137},\${SMB_UDP_138},\${ZK_CLIENT_PORT},\${ZK_QUORUM_PORT},\${ZK_ELECTION_PORT},\${SOLR_PORT},\${ACTIVEMQ_OPENWIRE_PORT},\${ACTIVEMQ_WEB_CONSOLE_PORT},\${ACTIVEMQ_AMQP_PORT},\${ACTIVEMQ_STOMP_PORT},\${ACTIVEMQ_MQTT_PORT},\${ACTIVEMQ_WS_PORT},\${POSTGRES_PORT},\${PIRANHA_PORT},\${BARRACUDA_PORT},\${WHIFF_PORT},\${SPLUNK_WEB_PORT},\${SPLUNK_MGMT_PORT},\${SPLUNK_HEC_PORT},\${SPLUNK_FORWARD_PORT}"
