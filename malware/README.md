# WADE Malware Analysis Utilities

Utilities and scripts for malware extraction, unpacking, and analysis within the WADE framework.

---

## ğŸ¯ Overview

The malware directory contains tools and workflows for:
- Extracting suspicious executables from disk/memory
- Unpacking/deobfuscating samples
- Automated triage and classification
- Sandbox submission workflows
- IOC extraction

---

## ğŸ“‚ Structure

```

malware/\
â”œâ”€â”€ extractors/ # Extraction scripts\
â”‚ â”œâ”€â”€ extract_pe.py # PE file extraction\
â”‚ â”œâ”€â”€ extract_scripts.py # PowerShell, VBS, JS\
â”‚ â””â”€â”€ carve_memory.py # Memory-based extraction\
â”œâ”€â”€ unpackers/ # Unpacking utilities\
â”‚ â”œâ”€â”€ upx_unpack.sh\
â”‚ â””â”€â”€ vmprotect_unpack.sh\
â”œâ”€â”€ triage/ # Quick analysis\
â”‚ â”œâ”€â”€ static_analysis.py\
â”‚ â””â”€â”€ strings_analysis.py\
â””â”€â”€ README.md

```

---

## ğŸ”§ Utilities

### PE Extraction

```bash
# Extract all PE files from disk image
python3 malware/extractors/extract_pe.py /path/to/disk.E01 --output /tmp/extracted/

# Filter by size/characteristics
python3 malware/extractors/extract_pe.py /path/to/disk.E01\
  --min-size 10KB\
  --max-size 5MB\
  --suspicious-only

```

### Script Extraction

```source-shell
# Extract obfuscated PowerShell/VBS/JS
python3 malware/extractors/extract_scripts.py /path/to/disk.E01 --output /tmp/scripts/
```

### Memory Carving

```source-shell
# Carve executables from memory dump
python3 malware/extractors/carve_memory.py /path/to/memory.dmp --output /tmp/carved/
```

* * * * *

ğŸ¯ Integration with WADE
------------------------

### Automatic Malware Classification

When a file is classified asÂ `malware`Â by the staging daemon, it routes to the malware toolkit:

```source-yaml
# etc/config.yaml
routing:
  defaults:
    malware:
      full: [yara, capa, sandbox_submit]
```

### YARA Detection

Malware samples are automatically scanned with YARA rules fromÂ `/opt/wade/yara/malware/`.

### Capa Analysis

[Mandiant Capa](https://github.com/mandiant/capa)Â analyzes malware capabilities:

```source-shell
# Run capa on extracted sample
capa /path/to/malware.exe --json > /tmp/capabilities.json
```

* * * * *

ğŸ“Š Output
---------

Extracted malware is organized by hash:

```
DataSources/malware/
â””â”€â”€ <hostname>/
    â””â”€â”€ extracted/
        â”œâ”€â”€ abc123def456.exe          # SHA256 filename
        â”œâ”€â”€ abc123def456_meta.json    # Metadata
        â””â”€â”€ abc123def456_capa.json    # Capa results

```

* * * * *

ğŸ›¡ï¸ Safety
----------

âš ï¸Â WARNING:Â Handle malware samples with extreme caution!

-   Always work in isolated environments
-   Use VMs with snapshots
-   Never execute samples on production systems
-   Follow your organization's malware handling policy

* * * * *

ğŸ“š Resources
------------

-   [Mandiant Capa](https://github.com/mandiant/capa)
-   [YARA Documentation](https://yara.readthedocs.io/)
-   [Malware Analysis Techniques](https://www.sans.org/white-papers/)

* * * * *

For more information:

-   [Main README](https://github.com/imcconnell15/WADE/README.md)
-   [YARA Rules](https://github.com/imcconnell15/WADE/yara/README.md)
-   [Worker Documentation](https://github.com/imcconnell15/WADE/wade_workers/README.md)
